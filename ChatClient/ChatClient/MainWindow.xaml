<Window x:Class="ChatClient.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Онлайн чат" Height="450" Width="800">

    <Grid Margin="10">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="220"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- Список контактов -->
        <DockPanel Grid.Column="0" Margin="0,0,10,0">
            <TextBlock Text="Контакты"
                       FontWeight="Bold"
                       DockPanel.Dock="Top"
                       Margin="0,0,0,5"/>

            <StackPanel DockPanel.Dock="Top" Margin="0,0,0,5">
                <TextBox x:Name="SearchContactTextBox"
                         Width="200"
                         Margin="0,0,0,5"/>
                <Button Content="Найти"
                        Width="80"
                        Click="FindContactButton_Click"/>
            </StackPanel>

            <ListBox x:Name="ContactsListBox"
                     DockPanel.Dock="Bottom"
                     Height="300"
                     SelectionChanged="ContactsListBox_SelectionChanged">

                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <Grid Margin="6">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="48"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <!-- Аватар -->
                            <Grid Width="40" Height="40">
                                <!-- Круглый аватар -->
                                <Ellipse Width="40" Height="40">
                                    <Ellipse.Fill>
                                        <ImageBrush ImageSource="{Binding AvatarPath}"
                                    Stretch="UniformToFill"/>
                                    </Ellipse.Fill>
                                </Ellipse>

                                <!-- Индикатор статуса -->
                                <Ellipse Width="10"
                                         Height="10"
                                         Fill="{Binding StatusColor}"
                                         Stroke="White"
                                         StrokeThickness="1.5"
                                         HorizontalAlignment="Right"
                                         VerticalAlignment="Bottom"
                                         Margin="0,0,1,1"/>
                            </Grid>

                            <!-- Имя и статус -->
                            <StackPanel Grid.Column="1" Margin="8,0,0,0" VerticalAlignment="Center">
                                <TextBlock Text="{Binding Name}"
                                           FontWeight="SemiBold"
                                           FontSize="13"/>
                                                <TextBlock Text="{Binding StatusText}"
                                                           Foreground="Gray"
                                                           FontSize="11"/>
                            </StackPanel>
                        </Grid>
                    </DataTemplate>
                </ListBox.ItemTemplate>

            </ListBox>
        </DockPanel>

        <!-- Чат -->
        <Grid Grid.Column="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Верхняя панель -->
            <StackPanel Grid.Row="0"
                        Orientation="Horizontal"
                        Margin="0,0,0,5">

                <TextBlock Text="Имя:" VerticalAlignment="Center"/>
                <TextBox x:Name="UserNameTextBox"
                         Width="120"
                         Margin="5,0,10,0"/>

                <TextBlock Text="Статус:" VerticalAlignment="Center"/>
                <TextBlock x:Name="ConnectionStatusTextBlock"
                           Margin="5,0,10,0"
                           VerticalAlignment="Center"
                           Foreground="Gray"/>

                <Button Content="Профиль"
                        Width="80"
                        Margin="0,0,5,0"
                        Click="ProfileButton_Click"/>

                <Button Content="Выйти"
                        Width="80"
                        Click="LogoutButton_Click"/>
            </StackPanel>

            <!-- Сообщения -->
            <ListBox x:Name="MessagesListBox"
                     Grid.Row="2"
                     Margin="0,0,0,5"
                     DisplayMemberPath="DisplayText"
                     MouseDoubleClick="MessagesListBox_MouseDoubleClick"
                     MouseRightButtonUp="MessagesListBox_MouseRightButtonUp"/>


            <!-- Ввод -->
            <Grid Grid.Row="3">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="75" />
                    <ColumnDefinition Width="95" />
                </Grid.ColumnDefinitions>

                <TextBox x:Name="MessageTextBox"
                         Grid.Column="0"
                         Margin="0,0,5,0"
                         MinHeight="28"
                         VerticalAlignment="Center"
                         KeyDown="MessageTextBox_KeyDown"/>

                <Button x:Name="AttachButton"
                        Grid.Column="1"
                        Content="Файл..."
                        Width="70"
                        MinHeight="28"
                        Margin="0,0,5,0"
                        VerticalAlignment="Center"
                        Click="AttachButton_Click"/>

                <Button x:Name="SendButton"
                        Grid.Column="2"
                        Content="Отправить"
                        Width="90"
                        MinHeight="28"
                        VerticalAlignment="Center"
                        Click="SendButton_Click"/>
            </Grid>
        </Grid>
    </Grid>
</Window>
